{"name":"reuben-sandbox","description":null,"organizationId":43565,"isEnabled":false,"crontab":null,"timezone":"Asia/Kolkata","blockData":[{"top":48,"left":48,"uuid":"998dc1e9-4c57-483f-a6e9-80c52a63068b","options":{},"pluginId":"startTrigger","blockType":"webhook","editorType":"JavascriptQuery","environment":"production","isMinimized":false,"resourceName":"webhook","incomingOnSuccessEdges":[]},{"top":2832,"left":-208,"uuid":"04603350-b691-48d3-8123-ba5f46042ddb","pluginId":"query4","blockType":"default","editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":2880,"left":272,"uuid":"88682c8a-e0c7-4984-8b40-bc7dc57bcb7e","options":{"iterable":"04603350-b691-48d3-8123-ba5f46042ddb","batchConfig":{"batchSize":1,"delayInMs":1},"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"loop4","blockType":"loop","dimensions":{"width":656,"height":687},"editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["04603350-b691-48d3-8123-ba5f46042ddb"]},{"top":3680,"left":-1152,"uuid":"a83a8673-11c8-4f37-b39a-cda25f03c4de","pluginId":"getProducts2","blockType":"default","dimensions":{"width":528,"height":496},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":3632,"left":-272,"uuid":"edbc9232-fada-4ee4-9936-722489ef5adf","pluginId":"code6","blockType":"code","dimensions":{"width":736,"height":688},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["a83a8673-11c8-4f37-b39a-cda25f03c4de"]},{"top":3680,"left":656,"uuid":"7132daf1-3c87-45a0-8ecd-6b6fb382a126","options":{"iterable":"edbc9232-fada-4ee4-9936-722489ef5adf","batchConfig":{"batchSize":1,"delayInMs":1},"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"loop5","blockType":"loop","dimensions":{"width":656,"height":687},"editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["edbc9232-fada-4ee4-9936-722489ef5adf"]},{"top":4880,"left":-1184,"uuid":"5834ea88-1445-4d8c-adf3-62b27217349f","pluginId":"getProducts3","blockType":"default","dimensions":{"width":528,"height":496},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":4912,"left":-320,"uuid":"9298e09c-46a4-465c-9044-5bd1609dfda4","pluginId":"code7","blockType":"code","dimensions":{"width":704,"height":800},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["5834ea88-1445-4d8c-adf3-62b27217349f"]},{"top":4880,"left":544,"uuid":"0d6d4d21-84e4-4755-8d0c-19f25046f5a0","pluginId":"code8","blockType":"code","dimensions":{"width":704,"height":800},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["9298e09c-46a4-465c-9044-5bd1609dfda4"]},{"top":48,"left":496,"uuid":"f9cd460e-4394-4557-add3-5df9c6dbdfa1","pluginId":"get_shop_data","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":48,"left":1200,"uuid":"3c2ba552-e189-4c42-b6e1-cde75edfcc1c","pluginId":"simulate_supply_chain","blockType":"code","dimensions":{"width":704,"height":672},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["f9cd460e-4394-4557-add3-5df9c6dbdfa1"]},{"top":64,"left":2800,"uuid":"599c5652-b30f-47b2-9f17-cec6907b87db","pluginId":"orchestrate_execution","blockType":"code","dimensions":{"width":768,"height":640},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":[]},{"top":-352,"left":3472,"uuid":"073b6e2a-148f-41cf-8ac5-33fdc1feb808","options":{"iterable":"599c5652-b30f-47b2-9f17-cec6907b87db","batchConfig":{"batchSize":1,"delayInMs":10},"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"post_sales","blockType":"loop","editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["599c5652-b30f-47b2-9f17-cec6907b87db"]},{"top":1328,"left":2160,"uuid":"5f544f3d-3214-4e37-b6b4-9a37450b4f37","pluginId":"code9","blockType":"code","dimensions":{"width":736,"height":688},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":-640,"left":464,"uuid":"ab24d1d7-17cb-49c9-852e-f51134590495","pluginId":"get_products_and_costs","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-640,"left":1056,"uuid":"fd84f0cc-be46-4d2a-8213-93e6722316bd","pluginId":"get_buy_counts","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-720,"left":1632,"uuid":"501645f1-d139-490e-86cd-8fc178f17952","pluginId":"get_sales_metrics","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-1424,"left":1088,"uuid":"323b2174-c0ad-43e2-9bd6-5698b942725f","pluginId":"code10","blockType":"code","dimensions":{"width":832,"height":448},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["ab24d1d7-17cb-49c9-852e-f51134590495","fd84f0cc-be46-4d2a-8213-93e6722316bd","501645f1-d139-490e-86cd-8fc178f17952"]},{"top":-1392,"left":224,"uuid":"d3f60e7b-a3d7-4e11-b859-463ed777007f","pluginId":"get_products_and_costs2","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":848,"left":-160,"uuid":"9be84b8e-19cd-4f85-9a7f-9810d7760940","pluginId":"query5","blockType":"default","dimensions":{"width":352,"height":272},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-320,"left":1600,"uuid":"9313ee40-aaa9-4e5f-bdf9-541545cda74b","pluginId":"code11","blockType":"code","editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":1184,"left":800,"uuid":"c9e84c5f-9cda-4797-8257-7d1b82b1bafe","pluginId":"code12","blockType":"code","dimensions":{"width":448,"height":192},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":1184,"left":1328,"uuid":"b51e22f9-a821-4f75-9461-a27ce27c964b","options":{"iterable":"c9e84c5f-9cda-4797-8257-7d1b82b1bafe","batchConfig":{"batchSize":1,"delayInMs":1},"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"loop7","blockType":"loop","editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["c9e84c5f-9cda-4797-8257-7d1b82b1bafe"]},{"top":-256,"left":2080,"uuid":"b2d34d72-943c-4559-be27-044128cba072","pluginId":"code13","blockType":"code","editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":832,"left":336,"uuid":"45b506df-7b3f-42d8-91eb-6f23542a6143","options":{"iterable":"9be84b8e-19cd-4f85-9a7f-9810d7760940","batchConfig":{"batchSize":1,"delayInMs":1},"timeoutInMs":120000,"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"loop8","blockType":"loop","editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["9be84b8e-19cd-4f85-9a7f-9810d7760940"]},{"top":1296,"left":3216,"uuid":"2147c3af-4da6-4dc2-964e-24f819a84445","pluginId":"code14","blockType":"code","dimensions":{"width":912,"height":528},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":16,"left":2208,"uuid":"5aac3904-e052-4d2d-a665-5b4b566ec253","pluginId":"code15","blockType":"code","editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["3c2ba552-e189-4c42-b6e1-cde75edfcc1c"]},{"top":-176,"left":-1728,"uuid":"a521d933-2460-4ef2-98bf-120114bdb8ca","pluginId":"get_shop_data2","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":["eb98ee40-eb98-47e3-a68a-6c74d24eb62d"]},{"top":896,"left":-1776,"uuid":"91a32c57-6a46-45c5-b9bb-bdf39a1755c0","pluginId":"get_shop_data3","blockType":"default","dimensions":{"width":496,"height":384},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-128,"left":-1008,"uuid":"ac5cc840-72cb-4c97-8109-bc4a9e7b7b0e","pluginId":"code16","blockType":"code","dimensions":{"width":704,"height":576},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["a521d933-2460-4ef2-98bf-120114bdb8ca","91a32c57-6a46-45c5-b9bb-bdf39a1755c0"]},{"top":1200,"left":-1088,"uuid":"de0da41a-cc15-4520-8157-edbc45935a7d","pluginId":"code17","blockType":"code","dimensions":{"width":1024,"height":496},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":["ac5cc840-72cb-4c97-8109-bc4a9e7b7b0e"]},{"top":-1056,"left":-1248,"uuid":"20f1dace-169e-4ddb-8787-44de966b5f97","pluginId":"code18","blockType":"code","dimensions":{"width":592,"height":528},"editorType":"PythonQuery","environment":"production","resourceName":"PythonQuery","incomingOnSuccessEdges":[]},{"top":-960,"left":-560,"uuid":"6d3aa472-abbe-4bee-a2f9-2c92c870cb01","pluginId":"code19","blockType":"code","editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["ac5cc840-72cb-4c97-8109-bc4a9e7b7b0e"]},{"top":-944,"left":-112,"uuid":"c6ba433a-e33d-4ec3-a50c-6a17d0b058a6","options":{"iterable":"6d3aa472-abbe-4bee-a2f9-2c92c870cb01","batchConfig":{"batchSize":1,"delayInMs":1},"executionMode":"sequential","iterationErrorConfig":{"errorPolicy":"ignore"}},"pluginId":"loop10","blockType":"loop","editorType":"RESTQuery","onboarding":false,"environment":"production","isMinimized":false,"resourceName":"Optiply Public API","incomingOnSuccessEdges":["6d3aa472-abbe-4bee-a2f9-2c92c870cb01"]},{"top":-1984,"left":-816,"uuid":"a0b0192f-055e-4ea6-8424-135fcbe4bc21","pluginId":"code20","blockType":"code","dimensions":{"width":448,"height":432},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":["ac5cc840-72cb-4c97-8109-bc4a9e7b7b0e"]},{"top":16,"left":-2576,"uuid":"eb98ee40-eb98-47e3-a68a-6c74d24eb62d","pluginId":"code21","blockType":"code","dimensions":{"width":400,"height":544},"editorType":"JavascriptQuery","environment":"production","resourceName":"JavascriptQuery","incomingOnSuccessEdges":[]},{"top":-1952,"left":-192,"uuid":"05ba9b80-cf89-4090-b1b3-f99fbde68706","pluginId":"query6","blockType":"default","dimensions":{"width":832,"height":288},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-480,"left":-96,"uuid":"6965d4da-e2d0-4daf-a814-48689c5cd54b","pluginId":"query7","blockType":"default","dimensions":{"width":528,"height":208},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-544,"left":-2176,"uuid":"e2ec7954-70a3-4b14-ba0d-7af4211c8a0f","pluginId":"query8","blockType":"default","dimensions":{"width":576,"height":400},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":592,"left":-2320,"uuid":"3bce1d84-eaa2-4446-b5de-77d875fa3752","pluginId":"query9","blockType":"default","dimensions":{"width":480,"height":368},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]},{"top":-2320,"left":-208,"uuid":"7113243e-fa8f-43d5-b391-449ea23a332d","pluginId":"query10","blockType":"default","dimensions":{"width":832,"height":288},"editorType":"SqlQueryUnified","environment":"production","resourceName":"Optiply_ProductionDB","incomingOnSuccessEdges":[]}],"templateData":"[\"~#iR\",[\"^ \",\"n\",\"appTemplate\",\"v\",[\"^ \",\"appMaxWidth\",\"100%\",\"appStyles\",\"\",\"appTesting\",null,\"appThemeId\",null,\"appThemeModeId\",null,\"appThemeName\",null,\"createdAt\",null,\"customComponentCollections\",[],\"customDocumentTitle\",\"\",\"customDocumentTitleEnabled\",false,\"customShortcuts\",[],\"experimentalFeatures\",[\"^ \",\"disableMultiplayerEditing\",false,\"multiplayerEditingEnabled\",false,\"sourceControlTemplateDehydration\",false],\"folders\",[\"~#iL\",[]],\"formAppSettings\",[\"^ \",\"customRedirectUrl\",\"\"],\"inAppRetoolPillAppearance\",\"NO_OVERRIDE\",\"instrumentationEnabled\",false,\"internationalizationSettings\",[\"^ \",\"internationalizationEnabled\",false,\"internationalizationFiles\",[]],\"isFetching\",false,\"isFormApp\",false,\"isGlobalWidget\",false,\"isMobileApp\",false,\"loadingIndicatorsDisabled\",false,\"markdownLinkBehavior\",\"auto\",\"mobileAppSettings\",[\"^ \",\"displaySetting\",[\"^ \",\"landscapeMode\",false,\"tabletMode\",false],\"mobileOfflineModeBannerMode\",\"default\",\"mobileOfflineModeDelaySync\",false,\"mobileOfflineModeEnabled\",false],\"mobileOfflineAssets\",[],\"multiScreenMobileApp\",false,\"notificationsSettings\",[\"^ \",\"globalQueryShowFailureToast\",true,\"globalQueryShowSuccessToast\",false,\"globalQueryToastDuration\",4.5,\"globalToastPosition\",\"bottomRight\"],\"pageCodeFolders\",[\"^ \"],\"pageLoadValueOverrides\",[\"^A\",[]],\"persistUrlParams\",false,\"plugins\",[\"~#iOM\",[\"startTrigger\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"startTrigger\",\"uuid\",null,\"_comment\",null,\"type\",\"datasource\",\"subtype\",\"JavascriptQuery\",\"namespace\",null,\"resourceName\",\"JavascriptQuery\",\"resourceDisplayName\",null,\"template\",[\"~#iM\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return null\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"style\",null,\"position2\",null,\"mobilePosition2\",null,\"mobileAppPosition\",null,\"tabIndex\",null,\"container\",\"\",\"^7\",\"~m1764238564110\",\"updatedAt\",\"~m1764238564110\",\"folder\",\"\",\"presetName\",null,\"screen\",null,\"boxId\",null,\"subBoxIds\",null]]],\"query4\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query4\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"UPDATE supplier_products\\nSET delivery_time = NULL\\nWHERE id IN (\\n  31260633, 31260601, 31260620, 31260622, 31260629, \\n  31260637, 31260610, 31260647, 31260631, 31260614, \\n  31260596, 31260608, 31260599, 31260639, 31260625, \\n  31260649, 31260652, 31260650, 31260607, 31260605, \\n  31260627, 31260603, 31260643, 31260654, 31260624, \\n  31260618, 31260635, 31260597\\n);\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768295594058\",\"^1E\",\"~m1768296228667\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"loop4\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"loop4\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"{\\n  \\\"data\\\": {\\n    \\\"type\\\": \\\"supplierProducts\\\",\\n    \\\"attributes\\\": {\\n      \\\"availability\\\": true\\n    }\\n  }\\n}\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"[{\\\"key\\\":\\\"Content-Type\\\",\\\"value\\\":\\\"application/vnd.api+json\\\"}]\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/supplierProducts/{{ value.id }}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"PATCH\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"raw\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768295618052\",\"^1E\",\"~m1768295703532\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"getProducts2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"getProducts2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"select wp.id, wp.sku, wp.name, wp.price as selling_price, wp.current_stock_on_hand , sp.price as purchase_price, s.name as supplier_name, s.id as supplier_id, wp.id as product_id, sp.id as supplier_product_id\\n  from webshop_products  wp\\n  join supplier_products sp \\n  on wp.id = sp.webshop_product_id\\n  join suppliers s on s.id = sp.supplier_id\\n  where wp.shop_id = 1380;\\n\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768301158623\",\"^1E\",\"~m1768301701940\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code6\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code6\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"// 1. INPUT: Robustly extract the array\\nconst rawSource = getProducts2.data;\\n\\n// logic: if 'rawSource' has a .data property that is an array, use that. \\n// Otherwise try using it directly or falling back to formatDataAsArray.\\nlet products = [];\\n\\nif (rawSource && Array.isArray(rawSource.data)) {\\n  products = rawSource.data; // This matches your JSON structure\\n} else if (Array.isArray(rawSource)) {\\n  products = rawSource;\\n} else {\\n  products = formatDataAsArray(rawSource);\\n}\\n\\n// Debugging: Log what we found\\nconsole.log(`Found ${products.length} products`);\\n\\n// Safety Check\\nif (!products || products.length === 0) {\\n  return [];\\n}\\n\\n// 2. DEFINITION: Scenario Logic\\nfunction assignProfile(name, sku) {\\n  if (!name) return \\\"Stable Demand\\\";\\n  const n = name.toLowerCase();\\n  \\n  // --- A. NEW & CRITICAL SUPPLY CHAIN SCENARIOS ---\\n  if (n.includes(\\\"barrier\\\") || n.includes(\\\"rice\\\") || n.includes(\\\"relief\\\")) return \\\"New Product\\\";\\n  if (n.includes(\\\"cerave\\\") || n.includes(\\\"snail\\\") || n.includes(\\\"corsx\\\")) return \\\"Stockout Prone\\\";\\n  if (n.includes(\\\"matte\\\") || n.includes(\\\"astringent\\\") || n.includes(\\\"charcoal\\\")) return \\\"Dead Stock\\\";\\n  if (n.includes(\\\"mascara\\\") || n.includes(\\\"brow\\\") || n.includes(\\\"pomade\\\")) return \\\"Erratic Demand\\\";\\n\\n  // --- B. TREND PATTERNS ---\\n  if (n.includes(\\\"glow\\\") || n.includes(\\\"rare\\\") || n.includes(\\\"fenty\\\")) return \\\"Positive Trend\\\";\\n  if (n.includes(\\\"sun\\\") || n.includes(\\\"spf\\\") || n.includes(\\\"anthelios\\\") || n.includes(\\\"bronzer\\\")) return \\\"Seasonal Summer\\\";\\n  if (n.includes(\\\"la mer\\\") || n.includes(\\\"wood\\\") || n.includes(\\\"baccarat\\\") || n.includes(\\\"ferulic\\\")) return \\\"Long Tail\\\";\\n  if (n.includes(\\\"mask\\\") || n.includes(\\\"peel\\\") || n.includes(\\\"micellar\\\")) return \\\"Lumpy Wholesale\\\";\\n  if (n.includes(\\\"blush\\\") || n.includes(\\\"lip\\\")) return \\\"Influencer Spikes\\\";\\n  if (n.includes(\\\"toner\\\")) return \\\"Negative Trend\\\";\\n\\n  return \\\"Stable Demand\\\";\\n}\\n\\n// 3. EXECUTION: Create PATCH Payloads\\nconst patchPayloads = products.map(p => {\\n  const scenario = assignProfile(p.name, p.sku);\\n  \\n  // Clean name: removes any existing tags like \\\"(Viral)\\\" to avoid duplicates\\n  const cleanName = p.name ? p.name.split('(')[0].trim() : \\\"Unknown Product\\\";\\n  const newName = `${cleanName} (${scenario})`;\\n\\n  return {\\n    \\\"id\\\": p.id, \\n    \\\"body\\\": {   \\n      \\\"data\\\": {\\n        \\\"type\\\": \\\"products\\\",\\n        \\\"attributes\\\": {\\n          \\\"name\\\": newName\\n        }\\n      }\\n    }\\n  };\\n});\\n\\nreturn patchPayloads;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768301205024\",\"^1E\",\"~m1768301450537\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"loop5\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"loop5\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"{{ value.body }}\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"[{\\\"key\\\":\\\"Content-Type\\\",\\\"value\\\":\\\"application/vnd.api+json\\\"}]\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/products/{{ value.id }}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"PATCH\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"raw\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768301392307\",\"^1E\",\"~m1768301462895\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"getProducts3\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"getProducts3\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n  wp.id as product_id,\\n  wp.uuid as product_uuid,       -- Required for stocks table\\n  wp.shop_uuid as webshop_uuid, -- Required for stocks table (Now directly from wp)\\n  wp.shop_id as webshop_id,\\n  wp.sku,\\n  wp.name,\\n  wp.price as selling_price,\\n  wp.current_stock_on_hand,\\n  sp.price as purchase_price,\\n  s.name as supplier_name,\\n  s.id as supplier_id,\\n  sp.id as supplier_product_id\\nFROM webshop_products wp\\nJOIN supplier_products sp ON wp.id = sp.webshop_product_id\\nJOIN suppliers s ON s.id = sp.supplier_id\\nWHERE wp.shop_id = 1380;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768308036527\",\"^1E\",\"~m1768308081670\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code7\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code7\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport numpy as np\\nfrom datetime import datetime, timedelta\\nimport random\\n\\n# 1. SETUP: Input Data\\ndata = getProducts3.data\\n\\n# 2. DEFINITIONS: Scenario & Demand Logic\\ndef parse_scenario(name):\\n    if not name or \\\"(\\\" not in name: return \\\"Stable Demand\\\"\\n    return name.split(\\\"(\\\")[1].replace(\\\")\\\", \\\"\\\")\\n\\ndef get_daily_demand(day_idx, scenario, selling_price):\\n    # Price Friction: Expensive items sell less often\\n    price_friction = 1.0\\n    if selling_price > 200: price_friction = 0.05\\n    elif selling_price > 100: price_friction = 0.15\\n    elif selling_price > 40: price_friction = 0.5\\n    \\n    # Intermittency (Probability of Sale)\\n    sale_prob = 1.0\\n    if scenario == \\\"Long Tail\\\": sale_prob = 0.05 \\n    elif scenario == \\\"Lumpy Wholesale\\\": sale_prob = 0.02 \\n    elif scenario == \\\"Dead Stock\\\": sale_prob = 0.10 \\n    elif scenario == \\\"Erratic Demand\\\": sale_prob = 0.40 \\n    elif scenario == \\\"Stable Demand\\\": sale_prob = 0.70 \\n    elif scenario == \\\"New Product\\\": \\n        # Ramps up from 0% to 80%\\n        sale_prob = min(0.8, max(0, (day_idx - 100) / 100))\\n    else: \\n        sale_prob = 0.95\\n    \\n    final_prob = sale_prob * (1 if scenario == \\\"Lumpy Wholesale\\\" else price_friction)\\n    \\n    # No sale today?\\n    if random.random() > final_prob: return 0\\n\\n    # Quantity Logic\\n    noise = np.random.normal(0, 1)\\n    if scenario == \\\"Lumpy Wholesale\\\": qty = int(random.uniform(50, 200))\\n    elif scenario == \\\"Stockout Prone\\\": qty = 30 + (noise * 10)\\n    elif scenario == \\\"Positive Trend\\\": qty = (10 * (1 + day_idx/200)) + (noise * 3)\\n    elif scenario == \\\"Seasonal Summer\\\": qty = 5 + (20 * max(0, np.sin((day_idx/365)*np.pi))) + (noise * 5)\\n    elif scenario == \\\"Erratic Demand\\\": qty = abs(random.gauss(10, 15)) \\n    elif scenario == \\\"Long Tail\\\": qty = random.choice([1, 1, 1, 2, 3])\\n    elif scenario == \\\"Dead Stock\\\": qty = max(1, 3 + noise)\\n    else: qty = 10 + (noise * 2)\\n\\n    # Random Spike (Influencer Effect)\\n    if random.random() > 0.995: qty += random.uniform(20, 50) \\n    \\n    return int(max(1, round(qty)))\\n\\n# 3. SIMULATION LOOP\\nstock_history = []\\nsales_history = [] \\nbuy_orders = []    \\n\\nhistory_days = 365\\nstart_date = datetime.now() - timedelta(days=history_days)\\n\\nfor p in data:\\n    scenario = parse_scenario(p['name'])\\n    price = float(p['selling_price'])\\n    current_stock = int(p['current_stock_on_hand'])\\n    \\n    # Initialize Simulation (Back-calculate start stock)\\n    sim_stock = current_stock + 500 \\n    lead_time = random.choice([7, 14, 30])\\n    reorder_point = 100\\n    pending_deliveries = []\\n\\n    for day in range(history_days):\\n        date_str = (start_date + timedelta(days=day)).strftime(\\\"%Y-%m-%d\\\")\\n        \\n        # A. Deliveries (Stock Up)\\n        arrived = 0\\n        new_pending = []\\n        for d_day, d_qty in pending_deliveries:\\n            if day >= d_day: arrived += d_qty\\n            else: new_pending.append((d_day, d_qty))\\n        pending_deliveries = new_pending\\n        sim_stock += arrived\\n        \\n        # B. Sales (Stock Down)\\n        demand = get_daily_demand(day, scenario, price)\\n        sold = min(sim_stock, demand)\\n        sim_stock -= sold\\n        \\n        if sold > 0:\\n             sales_history.append({\\n                \\\"product_id\\\": p['product_id'],\\n                \\\"product_uuid\\\": p['product_uuid'],\\n                \\\"webshop_id\\\": p['webshop_id'],\\n                \\\"webshop_uuid\\\": p['webshop_uuid'],\\n                \\\"date\\\": date_str,\\n                \\\"qty\\\": sold,\\n                # Add any other sales columns your DB needs\\n            })\\n\\n        # C. Reorder Logic\\n        incoming = sum([x[1] for x in pending_deliveries])\\n        if (sim_stock + incoming) < reorder_point:\\n            order_q = 500 if scenario in [\\\"Lumpy Wholesale\\\", \\\"Stockout Prone\\\"] else (10 if scenario == \\\"Long Tail\\\" else 150)\\n            pending_deliveries.append((day + lead_time, order_q))\\n            \\n            # Record BO\\n            buy_orders.append({\\n                \\\"supplier_id\\\": p['supplier_id'],\\n                \\\"product_id\\\": p['product_id'],\\n                \\\"date\\\": date_str,\\n                \\\"qty\\\": order_q,\\n                \\\"status\\\": \\\"received\\\" if (day + lead_time) < history_days else \\\"placed\\\"\\n                # Add columns matching your buy_orders table\\n            })\\n\\n        # D. SNAPSHOT for Database\\n        stock_history.append({\\n            \\\"product_id\\\": p['product_id'],\\n            \\\"product_uuid\\\": p['product_uuid'],\\n            \\\"webshop_id\\\": p['webshop_id'],\\n            \\\"webshop_uuid\\\": p['webshop_uuid'],\\n            \\\"on_hand\\\": sim_stock,\\n            \\\"date\\\": date_str\\n        })\\n\\n# 4. OUTPUT\\nreturn {\\n    \\\"stock\\\": stock_history,\\n    \\\"sales\\\": sales_history,\\n    \\\"buy_orders\\\": buy_orders\\n}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768308096684\",\"^1E\",\"~m1768308463092\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code8\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code8\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return code7.data.buy_orders;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768308609344\",\"^1E\",\"~m1768308652725\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_shop_data\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_shop_data\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    -- Product Details\\n    wp.id,\\n    wp.shop_id,\\n    wp.name,\\n    wp.sku,\\n    wp.price AS selling_price,\\n    wp.current_stock_on_hand,\\n    \\n    -- Financials & Lead Times\\n    sp.price AS purchase_price,\\n    -- Priority: Specific Product > General Supplier > Default 14\\n    COALESCE(sp.delivery_time, s.delivery_time, 14) AS product_delivery_time,\\n    \\n    -- Supplier Info\\n    s.id AS supplier_id\\n\\nFROM webshop_products wp \\nJOIN supplier_products sp ON wp.id = sp.webshop_product_id\\nJOIN suppliers s ON s.id = sp.supplier_id\\nWHERE s.webshop_id = 1380;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768739745158\",\"^1E\",\"~m1768992804050\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"simulate_supply_chain\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"simulate_supply_chain\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport numpy as np\\nimport uuid\\nfrom datetime import datetime, timedelta\\nimport random\\n\\n# ==============================================================================\\n# 1. INPUTS\\n# ==============================================================================\\ntry:\\n    data = get_shop_data.data \\nexcept NameError:\\n    data = []\\ndf = pd.DataFrame(data) if not isinstance(data, pd.DataFrame) else data\\n\\n# ==============================================================================\\n# 2. DEMAND ENGINE (Cleaned Up)\\n# ==============================================================================\\ndef get_base_demand(selling_price):\\n    # Velocity based on price\\n    if selling_price < 15: return 25  # Fast\\n    elif selling_price < 50: return 12 # Medium\\n    return 5 # Slow\\n\\ndef get_daily_demand(day_idx, scenario, base_qty, params, history_days):\\n    qty = 0\\n    \\n    # --- SCENARIO SHAPES ---\\n    if scenario == \\\"Stable Fast\\\": \\n        qty = base_qty * 1.5\\n    elif scenario == \\\"Stable Slow\\\": \\n        qty = base_qty * 0.5\\n    \\n    elif scenario == \\\"Positive Trend\\\":\\n        # Ramp up in the last 4 months (Day 240+)\\n        start_day = history_days - 120\\n        if day_idx < start_day: \\n            qty = base_qty\\n        else: \\n            # 1x -> 3x Growth\\n            progress = (day_idx - start_day) / 120\\n            qty = base_qty * (1 + (2.0 * progress))\\n            \\n    elif scenario == \\\"Negative Trend\\\":\\n        # Drop off in the last 4 months\\n        start_day = history_days - 120\\n        high_base = base_qty * 2.0\\n        if day_idx < start_day: \\n            qty = high_base\\n        else: \\n            # 100% -> 20% Decay\\n            progress = (day_idx - start_day) / 120\\n            qty = max(0, high_base * (1 - (0.8 * progress)))\\n\\n    elif \\\"Seasonal\\\" in scenario:\\n        peak = 170 # Summer\\n        width = 30\\n        if \\\"Winter\\\" in scenario: peak = 15\\n        if \\\"Holiday\\\" in scenario: peak = 330; width = 5\\n        \\n        # Gaussian curve\\n        factor = 3.0 * np.exp(-((day_idx - peak)**2) / (2 * width**2))\\n        \\n        if \\\"Winter\\\" in scenario: # Dec Peak\\n             factor = max(factor, 3.0 * np.exp(-((day_idx - 355)**2) / (2 * 20**2)))\\n             \\n        if \\\"Micro\\\" in scenario: # Monthly payday\\n            factor = 1.0 if (day_idx % 30) < 5 else 0.0\\n            \\n        qty = base_qty + (base_qty * factor)\\n\\n    elif \\\"Stockout\\\" in scenario:\\n        qty = base_qty * 2.0 # High demand\\n    \\n    elif \\\"Obsolete\\\" in scenario:\\n        # Stop selling 60 days ago\\n        qty = base_qty if day_idx < (history_days - 60) else 0\\n        \\n    elif \\\"Outlier\\\" in scenario:\\n        # 3 huge spikes in last 90 days\\n        is_recent = day_idx > (history_days - 90)\\n        if is_recent and random.random() > 0.97: \\n            qty = base_qty * 8.0 # Massive spike (e.g. 10 -> 80)\\n        else: \\n            qty = base_qty\\n\\n    elif \\\"New Launch\\\" in scenario:\\n        # STRICT 30 DAYS AGO LAUNCH\\n        launch_day = history_days - 30\\n        if day_idx < launch_day: \\n            qty = 0\\n        else:\\n            # Launch Boost\\n            qty = base_qty * 2.5\\n\\n    elif \\\"Container\\\" in scenario: qty = base_qty * 4.0\\n    elif \\\"Multi-Supplier\\\" in scenario: qty = base_qty * 1.5\\n    \\n    elif \\\"Sporadic\\\" in scenario:\\n        qty = 3 if random.random() > 0.92 else 0 # Sparse\\n        \\n    elif \\\"Lumpy\\\" in scenario:\\n        qty = 50 if random.random() > 0.97 else 0 # Bulk\\n        \\n    elif \\\"Step Change\\\" in scenario:\\n        # Jump at Day 200\\n        level = 1.0\\n        step_day = 200\\n        if \\\"Up\\\" in scenario and day_idx > step_day: level = 2.5\\n        if \\\"Down\\\" in scenario and day_idx > step_day: level = 0.5\\n        qty = base_qty * level\\n        \\n    else: qty = base_qty\\n\\n    # --- NOISE (Tuned for Readability) ---\\n    if qty > 0:\\n        # Lower volatility (15%) to make patterns clearer\\n        vol = random.uniform(0.85, 1.15)\\n        qty = qty * vol\\n        \\n        # Additive noise (only if not sporadic)\\n        if \\\"Sporadic\\\" not in scenario and \\\"Lumpy\\\" not in scenario:\\n            qty += np.random.normal(0, 1.0)\\n            \\n    return int(max(0, round(qty)))\\n\\ndef distribute_scenarios(count):\\n    all_types = [\\n        \\\"Stable Fast\\\", \\\"Stable Slow\\\", \\n        \\\"Positive Trend\\\", \\\"Negative Trend\\\",\\n        \\\"Seasonal (Summer)\\\", \\\"Seasonal (Winter)\\\", \\\"Seasonal (Holiday)\\\", \\\"Micro-Seasonality\\\",\\n        \\\"Stockout Prone (Demand)\\\", \\\"Stockout Prone (Supply)\\\", \\n        \\\"Obsolete / Dead\\\", \\\"Outlier Spikes (Influencer)\\\",\\n        \\\"Container Filler\\\", \\\"Multi-Supplier A-Class\\\", \\n        \\\"New Launch (Success)\\\", \\\"New Launch (Flop)\\\",\\n        \\\"Sporadic (Poisson)\\\", \\\"Lumpy (B2B)\\\", \\n        \\\"Step Change (Up)\\\", \\\"Step Change (Down)\\\"\\n    ]\\n    deck = []\\n    deck.extend(all_types)\\n    \\n    remainder = count - len(deck)\\n    if remainder > 0:\\n        favorites = [\\\"Stockout Prone (Demand)\\\", \\\"Outlier Spikes (Influencer)\\\", \\\"Seasonal (Summer)\\\", \\\"New Launch (Success)\\\"]\\n        deck.extend(random.choices(favorites, k=remainder))\\n    \\n    random.shuffle(deck)\\n    return deck[:count]\\n\\n# ==============================================================================\\n# 3. MAIN SIMULATION\\n# ==============================================================================\\nsales_csv_rows = [] \\nbo_map = {} \\nstock_history = []\\nname_updates = []\\norder_counter = 1\\ncontinuity_report = []\\n\\nhistory_days = 365 \\nstart_date_base = datetime.now() - timedelta(days=history_days)\\n\\nscenario_deck = distribute_scenarios(len(df))\\n\\nfor index, row in df.iterrows():\\n    p_id = row.get('id')\\n    p_sku = row.get('sku')\\n    supplier_id = row.get('supplier_id')\\n    w_id = row.get('shop_id')\\n    p_name = row.get('name')\\n    \\n    selling_price = float(row.get('selling_price', 0) or 0)\\n    purchase_price = float(row.get('purchase_price', 0) or 0)\\n    current_stock = int(row.get('current_stock_on_hand', 0) or 0)\\n    lead_time = int(row.get('product_delivery_time', 14))\\n\\n    # 1. SETUP\\n    clean_name = p_name.split(\\\"(\\\")[0].strip()\\n    scenario = scenario_deck[index] if index < len(scenario_deck) else \\\"Stable Fast\\\"\\n    new_name = f\\\"{clean_name} ({scenario})\\\"\\n    name_updates.append({\\\"id\\\": p_id, \\\"name\\\": new_name})\\n    \\n    if \\\"Container\\\" in scenario: selling_price = 5.0\\n    if \\\"Multi-Supplier\\\" in scenario: selling_price = 150.0\\n\\n    # 2. LOGISTICS PARAMETERS\\n    base_qty = get_base_demand(selling_price)\\n    \\n    # Calculate ROP based on the Scenario (So logic matches reality)\\n    avg_daily = base_qty\\n    if \\\"Fast\\\" in scenario or \\\"Container\\\" in scenario: avg_daily *= 2.0\\n    if \\\"Seasonal\\\" in scenario: avg_daily *= 1.5 # Higher buffer\\n    if \\\"Trend\\\" in scenario: avg_daily *= 1.5 \\n    if \\\"Stockout\\\" in scenario: avg_daily *= 2.0\\n    \\n    reorder_point = lead_time * avg_daily * 1.5 # 1.5x Lead Time Demand = Safe\\n    \\n    # Init Stock\\n    sim_stock = current_stock + 800 \\n    if \\\"New Launch\\\" in scenario: sim_stock = 0\\n    if \\\"Obsolete\\\" in scenario: sim_stock = 600\\n    if \\\"Sporadic\\\" in scenario or \\\"Lumpy\\\" in scenario: sim_stock = 60\\n    \\n    pending_deliveries = []\\n    missed_sales_days = 0\\n    total_sales = 0\\n\\n    for day in range(history_days):\\n        curr_date = start_date_base + timedelta(days=day)\\n        date_str = curr_date.strftime(\\\"%Y-%m-%d\\\")\\n        csv_date_str = curr_date.strftime(\\\"%d-%m-%Y\\\")\\n        iso_date = f\\\"{date_str}T12:00:00Z\\\"\\n        \\n        # --- SABOTAGE (Stockout Prone) ---\\n        active_rop = reorder_point\\n        \\n        # If Stockout Prone, cut ROP in the last 90 days\\n        # Set ROP to 80% of Lead Time Demand (guarantees a gap)\\n        if \\\"Stockout\\\" in scenario and day > (history_days - 90):\\n             active_rop = (lead_time * avg_daily) * 0.8\\n        \\n        # If Obsolete, stop ordering\\n        if \\\"Obsolete\\\" in scenario and day > (history_days - 60):\\n             active_rop = -9999\\n\\n        # A. INBOUND\\n        arrived = 0\\n        new_pending = []\\n        for d_day, d_qty, d_uuid in pending_deliveries:\\n            if day >= d_day:\\n                arrived += d_qty\\n                if d_uuid in bo_map:\\n                    bo_map[d_uuid][\\\"receipt_plan\\\"].append({\\n                        \\\"quantity\\\": d_qty, \\\"occurred\\\": iso_date, \\\"productId\\\": p_id\\n                    })\\n            else:\\n                new_pending.append((d_day, d_qty, d_uuid))\\n        pending_deliveries = new_pending\\n        sim_stock += arrived\\n\\n        # B. SALES\\n        demand = get_daily_demand(day, scenario, base_qty, {}, history_days)\\n        \\n        # New Launch Injection (30 days ago)\\n        if \\\"New Launch\\\" in scenario and day == (history_days - 30):\\n            sim_stock += int(avg_daily * 45) # 1.5 months stock\\n            \\n        sold = demand\\n        if \\\"Stockout\\\" in scenario:\\n            if demand > sim_stock:\\n                missed_sales_days += 1\\n                sold = max(0, sim_stock)\\n        \\n        sim_stock -= sold \\n        total_sales += sold\\n        \\n        if sold > 0:\\n            sales_csv_rows.append({\\n                \\\"remote_order_id\\\": str(order_counter),\\n                \\\"ean\\\": \\\"\\\", \\\"sku_id\\\": p_sku, \\n                \\\"quantity\\\": sold,\\n                \\\"subtotalvalue\\\": round(sold * selling_price, 2),\\n                \\\"placed\\\": csv_date_str, \\\"completed\\\": csv_date_str\\n            })\\n            order_counter += 1\\n\\n        # C. REORDER\\n        incoming = sum([x[1] for x in pending_deliveries])\\n        \\n        if (sim_stock + incoming) < active_rop:\\n            # Order enough for 45 days\\n            order_q = int(avg_daily * (lead_time + 45))\\n            if \\\"Container\\\" in scenario: order_q = max(order_q, 2000)\\n            if \\\"Sporadic\\\" in scenario: order_q = 20\\n            if order_q < 10: order_q = 10\\n            \\n            # Lead Time Variance for Multi-Supplier\\n            actual_lead = lead_time\\n            if \\\"Multi-Supplier\\\" in scenario and random.random() > 0.7:\\n                actual_lead = random.randint(25, 45)\\n            \\n            delivery_day = day + actual_lead\\n            internal_uuid = str(uuid.uuid4())\\n            pending_deliveries.append((delivery_day, order_q, internal_uuid))\\n            \\n            expected_date = (start_date_base + timedelta(days=delivery_day)).strftime(\\\"%Y-%m-%dT12:00:00Z\\\")\\n            \\n            bo_map[internal_uuid] = {\\n                \\\"internal_ref_id\\\": internal_uuid,\\n                \\\"api_payload\\\": {\\n                    \\\"data\\\": {\\n                        \\\"type\\\": \\\"buyOrders\\\",\\n                        \\\"attributes\\\": {\\n                            \\\"supplierId\\\": supplier_id,\\n                            \\\"placed\\\": iso_date, \\\"completed\\\": iso_date,\\n                            \\\"expectedDeliveryDate\\\": expected_date,\\n                            \\\"totalValue\\\": round(order_q * purchase_price, 2),\\n                            \\\"orderLines\\\": [{\\n                                \\\"quantity\\\": order_q, \\n                                \\\"subtotalValue\\\": round(order_q * purchase_price, 2), \\n                                \\\"productId\\\": p_id,\\n                                \\\"expectedDeliveryDate\\\": expected_date\\n                            }]\\n                        }\\n                    }\\n                },\\n                \\\"receipt_plan\\\": []\\n            }\\n\\n        # D. SNAPSHOT\\n        stock_history.append({\\n            \\\"product_id\\\": p_id, \\\"webshop_id\\\": w_id, \\\"on_hand\\\": max(0, sim_stock), \\\"date\\\": date_str\\n        })\\n    \\n    status = \\\" Continuous\\\"\\n    if missed_sales_days > 0: status = f\\\" {missed_sales_days} Gaps\\\"\\n    \\n    continuity_report.append({\\n        \\\"product\\\": new_name,\\n        \\\"scenario\\\": scenario,\\n        \\\"status\\\": status,\\n        \\\"total_sales\\\": total_sales\\n    })\\n\\n# 4. EXPORT\\nif not sales_csv_rows:\\n    csv_string = \\\"\\\"\\nelse:\\n    csv_df = pd.DataFrame(sales_csv_rows)\\n    cols = [\\\"remote_order_id\\\", \\\"ean\\\", \\\"sku_id\\\", \\\"quantity\\\", \\\"subtotalvalue\\\", \\\"placed\\\", \\\"completed\\\"]\\n    for col in cols:\\n        if col not in csv_df.columns: csv_df[col] = \\\"\\\"\\n    csv_string = csv_df[cols].to_csv(index=False)\\n\\nreturn {\\n    \\\"stocks\\\": stock_history,\\n    \\\"sales_csv\\\": csv_string,\\n    \\\"buy_orders\\\": list(bo_map.values()),\\n    \\\"name_updates\\\": name_updates,\\n    \\\"continuity_report\\\": continuity_report\\n}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768740560453\",\"^1E\",\"~m1769152979610\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"orchestrate_execution\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"orchestrate_execution\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"// 1. LOAD DATA\\nconst sales = simulate_supply_chain.data.sales;\\nconst buyOrders = simulate_supply_chain.data.buy_orders;\\n\\n// ==================================================\\n// PHASE 1: PREPARE SALES ARRAY\\n// ==================================================\\n// Simply extract the inner data object if needed, or pass as is.\\n// Structure: [ { data: { type: \\\"sellOrders\\\", ... } }, ... ]\\nconst salesPayloads = sales.map(s => s.data);\\n\\n// ==================================================\\n// PHASE 2: PREPARE BUY ORDER & RECEIPT ARRAYS\\n// ==================================================\\nconst boPayloads = [];\\nconst receiptPayloads = [];\\n\\nfor (const orderRequest of buyOrders) {\\n  \\n  // A. Buy Order Payload\\n  // We need to attach a temporary \\\"internal_ref_id\\\" to the payload so your Loop Runner\\n  // can match the created API ID back to the receipts in the next step.\\n  // Since we can't easily modify the API payload structure if it's strict,\\n  // we'll output a wrapper object for your Runner to handle.\\n  \\n  const internalId = crypto.randomUUID(); // Unique ID for this batch grouping\\n  \\n  boPayloads.push({\\n    internal_ref_id: internalId,\\n    api_payload: orderRequest.payload.data // The actual JSON for POST /v1/buyOrders\\n  });\\n  \\n  // B. Receipt Payloads\\n  // These need to know which BO they belong to. Since we don't have the real API ID yet,\\n  // we tag them with the 'internal_ref_id'. Your Receipt Loop Runner will need to \\n  // look up the real ID from the Buy Order Loop Runner's results using this ref_id.\\n  \\n  const receipts = orderRequest.receipt_plan;\\n  if (receipts && receipts.length > 0) {\\n    for (const receipt of receipts) {\\n      receiptPayloads.push({\\n        internal_ref_id: internalId, // Link to the BO above\\n        productId: receipt.productId, // Helper to find the specific Line Item ID\\n        api_payload: {\\n          data: {\\n            type: \\\"receiptLines\\\",\\n            attributes: {\\n              occurred: receipt.occurred,\\n              quantity: receipt.quantity,\\n              // \\\"buyOrderLineId\\\": ??? -> To be filled by your Loop Runner logic\\n            }\\n          }\\n        }\\n      });\\n    }\\n  }\\n}\\n\\nreturn {\\n  sales: salesPayloads,\\n  buy_orders: boPayloads,\\n  receipts: receiptPayloads\\n};\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768741203481\",\"^1E\",\"~m1769088672567\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"post_sales\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"post_sales\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"{{ orchestrate_execution.data.sales }}\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"[{\\\"key\\\":\\\"Content-Type\\\",\\\"value\\\":\\\"application/vnd.api+json\\\"}]\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/sellOrders?accountId=1380\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"POST\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"raw\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768743001862\",\"^1E\",\"~m1768743074264\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code9\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code9\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return simulate_supply_chain.data.sales_csv\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768764456417\",\"^1E\",\"~m1769001116826\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_products_and_costs\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_products_and_costs\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    wp.id as product_id,\\n    COALESCE(sp.price, 0) as unit_cost,       -- From Supplier (Purchase Price)\\n    wp.price as selling_price,                -- From Webshop (Selling Price)\\n    COALESCE(wp.current_stock_on_hand, 0) as current_stock_on_hand,\\n    COALESCE(wp.service_level, 0) as service_level\\nFROM webshop_products wp \\nJOIN supplier_products sp ON wp.id = sp.webshop_product_id \\nWHERE wp.shop_id = 1305 \\n  AND wp.deleted_at IS NULL \\n  AND wp.status = 'enabled'\\n  AND sp.active = TRUE \\n  AND sp.deleted_at IS NULL;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768803947628\",\"^1E\",\"~m1768803952745\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_buy_counts\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_buy_counts\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    product_id, \\n    COUNT(id) as buy_count\\nFROM buy_order_lines\\nWHERE webshop_id = 1305 \\n  AND deleted_at IS NULL\\nGROUP BY product_id;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768803956317\",\"^1E\",\"~m1768803983480\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_sales_metrics\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_sales_metrics\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    product_id,\\n    \\n    -- Metric 1: 30-Day Revenue (For Service Level Weighting & Turnover)\\n    SUM(CASE \\n        WHEN placed >= CURRENT_DATE - INTERVAL '30 days' THEN subtotal_value \\n        ELSE 0 \\n    END) as revenue_30d,\\n    \\n    -- Metric 2: 1-Year Sell Orders (Count Unique Orders)\\n    COUNT(DISTINCT sell_order_id) as sell_orders_1y,\\n    \\n    -- Metric 3: 1-Year Sell Order Lines (Count Total Lines)\\n    COUNT(id) as sell_order_lines_1y\\n\\nFROM sell_order_lines\\nWHERE webshop_id = 1305 \\n  -- We filter the whole query to 1 year to keep it relevant\\n  AND placed >= CURRENT_DATE - INTERVAL '1 year'\\nGROUP BY product_id;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768803989299\",\"^1E\",\"~m1768812581545\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code10\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code10\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport numpy as np\\n\\n# 1. Load Data\\ndf_main = pd.DataFrame(get_products_and_costs.data)\\ndf_buys = pd.DataFrame(get_buy_counts.data)\\ndf_sales = pd.DataFrame(get_sales_metrics.data) # <--- Updated Source\\n\\nif not df_main.empty:\\n    # 2. Merge Data\\n    df = df_main.merge(df_buys, on='product_id', how='left')\\n    df = df.merge(df_sales, on='product_id', how='left')\\n\\n    # 3. Fill Missing Values & Fix Types\\n    # Fill Sales Metrics with 0\\n    df['revenue_30d'] = df['revenue_30d'].fillna(0.0).astype(float)\\n    df['sell_orders_1y'] = df['sell_orders_1y'].fillna(0).astype(int)\\n    df['sell_order_lines_1y'] = df['sell_order_lines_1y'].fillna(0).astype(int)\\n    \\n    df['buy_count'] = df['buy_count'].fillna(0).astype(int)\\n    df['unit_cost'] = df['unit_cost'].fillna(0.0).astype(float)\\n    df['service_level'] = df['service_level'].fillna(0.0).astype(float)\\n    df['current_stock_on_hand'] = df['current_stock_on_hand'].fillna(0.0).astype(float)\\n\\n    # 4. Define Categories\\n    def get_category(count):\\n        if count >= 4:\\n            return '4+ BOLs (Replenished 3+ times)'\\n        elif count >= 2:\\n            return '2-3 BOLs (Replenished 1-2 times)'\\n        else:\\n            return '0-1 BOLs (Low/No Replenishment)'\\n\\n    df['category'] = df['buy_count'].apply(get_category)\\n\\n    # 5. Calculate Weights\\n    # Weight = Revenue (30d) + 1\\n    df['weight'] = df['revenue_30d'] + 1\\n    df['inventory_value'] = df['current_stock_on_hand'] * df['unit_cost']\\n\\n    # 6. Aggregation\\n    results = df.groupby('category').apply(lambda x: pd.Series({\\n        'product_count': len(x),\\n        \\n        # New 1-Year Metrics\\n        'total_sell_orders_1y': x['sell_orders_1y'].sum(),\\n        \\n        # Existing Metrics\\n        'total_bols': x['buy_count'].sum(),\\n        'weighted_service_level': (x['service_level'] * x['weight']).sum() / x['weight'].sum() * 100,\\n        'turnover_days': (x['inventory_value'].sum() / x['revenue_30d'].sum() * 30) if x['revenue_30d'].sum() > 0 else 0.0,\\n        'total_revenue_30d': x['revenue_30d'].sum()\\n    })).reset_index()\\n\\n    # 7. Add Percentage Share\\n    total_products = results['product_count'].sum()\\n    results['pct_share'] = (results['product_count'] / total_products * 100)\\n\\n    # Formatting\\n    results = results.round(2).sort_values('total_revenue_30d', ascending=False)\\n    \\n    return results.to_dict('records')\\n\\nelse:\\n    return []\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768804044635\",\"^1E\",\"~m1768812728500\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_products_and_costs2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_products_and_costs2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    wp.id as product_id,\\n    COALESCE(sp.price, 0) as unit_cost,       -- From Supplier (Purchase Price)\\n    wp.price as selling_price,                -- From Webshop (Selling Price)\\n    COALESCE(wp.current_stock_on_hand, 0) as current_stock_on_hand,\\n    COALESCE(wp.service_level, 0) as service_level\\nFROM webshop_products wp \\nJOIN supplier_products sp ON wp.id = sp.webshop_product_id \\nWHERE wp.shop_id = 1305 \\n  AND wp.deleted_at IS NULL \\n  AND wp.status = 'enabled'\\n  AND sp.active = TRUE \\n  AND sp.deleted_at IS NULL;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768812500440\",\"^1E\",\"~m1768812500440\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query5\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query5\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"select \\nid \\nfrom sell_orders \\nwhere webshop_id = 1380;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768987445272\",\"^1E\",\"~m1768987462587\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code11\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code11\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return simulate_supply_chain.data.sales_csv\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768992859911\",\"^1E\",\"~m1768992868959\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code12\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code12\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return simulate_supply_chain.data.name_updates\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768993393872\",\"^1E\",\"~m1768993398435\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"loop7\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"loop7\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"{\\n  \\\"data\\\": {\\n    \\\"type\\\": \\\"products\\\",\\n    \\\"attributes\\\": {\\n      \\\"name\\\": {{ value.name }}\\n    }\\n  }\\n}\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"[{\\\"key\\\":\\\"Content-Type\\\",\\\"value\\\":\\\"application/vnd.api+json\\\"}]\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/products/{{ value.id }}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"PATCH\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"raw\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768993503824\",\"^1E\",\"~m1768993620288\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code13\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code13\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return simulate_supply_chain.data.continuity_report\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1768994516984\",\"^1E\",\"~m1768994522650\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"loop8\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"loop8\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/sellOrders/{{value.id}}?accountId=1380\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"120000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"DELETE\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"json\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769085466469\",\"^1E\",\"~m1769085466469\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code14\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code14\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport io\\nimport numpy as np\\n\\n# 1. READ DATA\\ntry:\\n    csv_content = simulate_supply_chain.data.sales_csv\\nexcept NameError:\\n    return [{\\\"error\\\": \\\"Input not found.\\\"}]\\n\\nif not csv_content:\\n    return [{\\\"error\\\": \\\"CSV is empty.\\\"}]\\n\\ndf = pd.read_csv(io.StringIO(csv_content))\\ndf['placed'] = pd.to_datetime(df['placed'], dayfirst=True, errors='coerce')\\n\\n# 2. SPARKLINE GENERATOR\\ndef get_sparkline(series, width=15):\\n    if len(series) == 0: return \\\"_\\\" * width\\n    chunks = np.array_split(series, width)\\n    vals = [c.sum() for c in chunks]\\n    mn, mx = min(vals), max(vals)\\n    rng = mx - mn if mx != mn else 1\\n    chars = \\\" \\\"\\n    line = \\\"\\\"\\n    for v in vals:\\n        if v == 0: line += \\\"_\\\" \\n        else:\\n            idx = int(((v - mn) / rng) * (len(chars) - 1))\\n            line += chars[idx]\\n    return line\\n\\n# 3. ANALYZE\\nreport = []\\nunique_skus = df['sku_id'].unique()\\nglobal_end = df['placed'].max()\\nglobal_start = global_end - pd.Timedelta(days=364)\\nfull_year_idx = pd.date_range(start=global_start, end=global_end)\\n\\nfor sku in unique_skus:\\n    subset = df[df['sku_id'] == sku].sort_values('placed')\\n    daily = subset.set_index('placed')['quantity'].reindex(full_year_idx).fillna(0)\\n    \\n    total = int(daily.sum())\\n    mx = int(daily.max())\\n    \\n    # METRICS\\n    last_90 = daily.tail(90)\\n    gaps_90d = (last_90 == 0).sum()\\n    \\n    # SMART STATUS LOGIC\\n    status = \\\" Healthy\\\"\\n    \\n    # 1. Check for \\\"New Launch\\\" (Zeros at start, Sales at end)\\n    if daily.iloc[:180].sum() == 0 and daily.iloc[-30:].sum() > 0:\\n        status = \\\" New Launch\\\"\\n        \\n    # 2. Check for \\\"Obsolete\\\" (Sales at start, Zeros at end)\\n    elif daily.iloc[:90].sum() > 0 and daily.iloc[-60:].sum() == 0:\\n        status = \\\" Obsolete / Dead\\\"\\n        \\n    # 3. Check for \\\"True Stockout\\\" (Gaps in the middle of active sales)\\n    elif gaps_90d > 5:\\n        status = f\\\" Stockout ({gaps_90d} days)\\\"\\n        \\n    # 4. Check for \\\"Trends\\\" & \\\"Outliers\\\"\\n    elif daily.iloc[-30:].mean() > (daily.iloc[:30].mean() * 2.0):\\n        status = \\\" Trending Up\\\"\\n    elif mx > (daily[daily>0].median() * 5) and mx > 50:\\n        status = f\\\" Outlier (Peak {mx})\\\"\\n\\n    report.append({\\n        \\\"sku\\\": sku,\\n        \\\"status\\\": status,\\n        \\\"total_sales\\\": total,\\n        \\\"max_day\\\": mx,\\n        \\\"recent_gaps\\\": int(gaps_90d),\\n        \\\"trend_graph\\\": get_sparkline(daily.values)\\n    })\\n\\nreturn report\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769088000825\",\"^1E\",\"~m1769153111674\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code15\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code15\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return simulate_supply_chain.data.buy_orders\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769153381900\",\"^1E\",\"~m1769153394792\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_shop_data2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_shop_data2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"{{ code21.data }}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769154276646\",\"^1E\",\"~m1769165223748\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"get_shop_data3\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"get_shop_data3\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT \\n    product_id, \\n    quantity, \\n    placed -- Ensure this is a DATE or DATETIME format\\nFROM \\n    sell_order_lines \\nWHERE \\n    webshop_id = 1380\\n    --AND placed >= CURRENT_DATE - INTERVAL '1 year' -- Optional: Limit to 1 year\\nORDER BY \\n    placed ASC\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769154286476\",\"^1E\",\"~m1769154309025\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code16\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code16\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport numpy as np\\nimport uuid\\nimport random\\nfrom datetime import datetime, timedelta\\n\\n# ==============================================================================\\n# 1. LOAD DATA & CLEANING\\n# ==============================================================================\\ntry:\\n    products_data = get_shop_data2.data \\n    df_products = pd.DataFrame(products_data)\\n    \\n    # Safe UUID handling\\n    if 'uuid' not in df_products.columns: df_products['uuid'] = None\\n    if 'webshop_uuid' not in df_products.columns: \\n        df_products['webshop_uuid'] = df_products.get('shop_uuid', None)\\n\\n    sales_data = get_shop_data3.data \\n    df_sales = pd.DataFrame(sales_data)\\n    \\n    # Strip Timezones for consistent comparison\\n    if 'placed' in df_sales.columns:\\n        df_sales['placed'] = pd.to_datetime(df_sales['placed'], utc=True).dt.tz_localize(None)\\n    \\nexcept NameError:\\n    return {\\\"error\\\": \\\"Resources 'get_shop_data2' or 'get_shop_data3' not found.\\\"}\\n\\n# ==============================================================================\\n# 2. HELPER: SALES BLOCKS\\n# ==============================================================================\\ndef get_sales_blocks(daily_demand):\\n    blocks = []\\n    in_block = False\\n    current_block = {}\\n    daily_demand = daily_demand.sort_index()\\n    for date, qty in daily_demand.items():\\n        qty_val = float(qty)\\n        if qty_val > 0:\\n            if not in_block:\\n                in_block = True\\n                current_block = {'start': date, 'end': date, 'total': qty_val}\\n            else:\\n                current_block['end'] = date\\n                current_block['total'] += qty_val\\n        else:\\n            if in_block:\\n                in_block = False\\n                blocks.append(current_block)\\n                current_block = {}\\n    if in_block: blocks.append(current_block)\\n    return blocks\\n\\n# ==============================================================================\\n# 3. SIMULATION ENGINE\\n# ==============================================================================\\nstock_history = []\\nbuy_orders = {}\\nsim_end_date = datetime.now().replace(microsecond=0)\\n\\n# Timeline Setup\\nif not df_sales.empty:\\n    start_date = df_sales['placed'].min()\\n    end_date = df_sales['placed'].max()\\n    if (end_date - start_date).days < 90: start_date = end_date - timedelta(days=90)\\n    if end_date < sim_end_date: end_date = sim_end_date\\n    full_timeline = pd.date_range(start=start_date, end=end_date)\\nelse:\\n    start_date = sim_end_date - timedelta(days=365)\\n    full_timeline = pd.date_range(start=start_date, end=sim_end_date)\\n\\nfor index, prod in df_products.iterrows():\\n    p_id = prod.get('id')\\n    p_uuid = prod.get('product_uuid')\\n    w_id = prod.get('shop_id')\\n    w_uuid = prod.get('webshop_uuid')\\n    \\n    prod_sales = df_sales[df_sales['product_id'] == p_id].copy()\\n    if prod_sales.empty:\\n        daily_demand = pd.Series(0, index=full_timeline)\\n    else:\\n        prod_sales['date'] = prod_sales['placed'].dt.floor('d')\\n        daily_demand = prod_sales.groupby('date')['quantity'].sum().reindex(full_timeline).fillna(0)\\n    \\n    sales_blocks = get_sales_blocks(daily_demand)\\n    \\n    total_sales = float(daily_demand.sum())\\n    avg_sales = float(daily_demand[daily_demand > 0].mean()) if total_sales > 0 else 0.0\\n    \\n    scenario = \\\"Stable\\\"\\n    if total_sales == 0: scenario = \\\"Dead\\\"\\n    elif daily_demand.iloc[:30].sum() == 0 and total_sales > 0: scenario = \\\"New Launch\\\"\\n    \\n    lead_time = int(prod.get('product_delivery_time', 14))\\n    coverage_days = 45 if \\\"New Launch\\\" in scenario else 30\\n    rop = float(lead_time * avg_sales)\\n    \\n    sim_stock = 0.0\\n    first_block = next((b for b in sales_blocks if b['start'] <= start_date <= b['end']), None)\\n    if first_block: sim_stock = rop * 1.5\\n    \\n    pending_inbound = []\\n    \\n    # Day Loop\\n    for date in full_timeline:\\n        date_str = date.strftime(\\\"%Y-%m-%d\\\")\\n        \\n        # 1. Receive\\n        arrived = 0\\n        new_pending = []\\n        for d_actual, d_qty, d_uuid in pending_inbound:\\n            if date >= d_actual:\\n                arrived += d_qty\\n            else:\\n                new_pending.append((d_actual, d_qty, d_uuid))\\n        pending_inbound = new_pending\\n        sim_stock += arrived\\n        \\n        # 2. Sell\\n        sold = float(daily_demand.loc[date])\\n        sim_stock -= sold\\n        \\n        # 3. Reorder Logic\\n        should_order = False\\n        expected_arrival = date + timedelta(days=lead_time)\\n        \\n        future_block = next((b for b in sales_blocks if b['start'] == expected_arrival), None)\\n        current_block = next((b for b in sales_blocks if b['start'] <= expected_arrival <= b['end']), None)\\n        \\n        incoming = sum([x[1] for x in pending_inbound])\\n        projected = sim_stock + incoming\\n        order_qty = 0.0\\n        \\n        if future_block:\\n            should_order = True\\n            order_qty = min(float(avg_sales * coverage_days), float(future_block['total']))\\n            if \\\"New Launch\\\" in scenario and sim_stock <= 0: \\n                expected_arrival = future_block['start'] - timedelta(days=1)\\n        elif current_block and projected < rop:\\n            should_order = True\\n            rem_demand = float(daily_demand.loc[expected_arrival : current_block['end']].sum())\\n            order_qty = min(float(avg_sales * coverage_days), rem_demand - projected)\\n            if order_qty <= 0: should_order = False\\n            \\n        safe_qty = int(order_qty)\\n        \\n        if should_order and safe_qty > 0:\\n            po_uuid = str(uuid.uuid4())\\n            \\n            # Lateness (20% chance)\\n            delay_days = 0\\n            if random.random() < 0.20:\\n                delay_days = random.randint(3, 12)\\n            actual_arrival = expected_arrival + timedelta(days=delay_days)\\n            \\n            pending_inbound.append((actual_arrival, safe_qty, po_uuid))\\n            \\n            # API Strings\\n            iso_placed = date.strftime(\\\"%Y-%m-%dT12:00:00Z\\\")\\n            iso_expected = expected_arrival.strftime(\\\"%Y-%m-%dT12:00:00Z\\\")\\n            iso_actual = actual_arrival.strftime(\\\"%Y-%m-%dT12:00:00Z\\\")\\n            \\n            is_open = actual_arrival > sim_end_date\\n            \\n            if po_uuid not in buy_orders:\\n                unit_price = float(prod.get('purchase_price', 0) or 0)\\n                subtotal = float(round(safe_qty * unit_price, 2))\\n                \\n                # --- BUILD ATTRIBUTES ---\\n                attributes = {\\n                    \\\"supplierId\\\": prod.get('supplier_id'),\\n                    \\\"placed\\\": iso_placed, \\n                    \\\"expectedDeliveryDate\\\": iso_expected,\\n                    \\\"totalValue\\\": subtotal,\\n                    \\\"orderLines\\\": [{\\n                        \\\"quantity\\\": safe_qty,\\n                        \\\"productId\\\": p_id,\\n                        \\\"subtotalValue\\\": subtotal, # <--- ADDED AS REQUIRED\\n                        \\\"expectedDeliveryDate\\\": iso_expected\\n                    }]\\n                }\\n                \\n                # Only add 'completed' if it's not an open order\\n                if not is_open:\\n                    attributes[\\\"completed\\\"] = iso_actual \\n                \\n                buy_orders[po_uuid] = {\\n                    \\\"data\\\": {\\n                        \\\"type\\\": \\\"buyOrders\\\",\\n                        \\\"attributes\\\": attributes\\n                    }\\n                }\\n\\n        stock_history.append({\\n            \\\"product_id\\\": p_id,\\n            \\\"product_uuid\\\": p_uuid,\\n            \\\"webshop_id\\\": w_id,\\n            \\\"webshop_uuid\\\": w_uuid,\\n            \\\"quantity\\\": int(max(0, sim_stock)),\\n            \\\"date\\\": date_str\\n        })\\n\\n# ==============================================================================\\n# 4. OUTPUTS\\n# ==============================================================================\\nbo_list = list(buy_orders.values())\\nbatch_size = 2000\\nstock_batches = [stock_history[i:i + batch_size] for i in range(0, len(stock_history), batch_size)]\\n\\nreturn {\\n    \\\"buy_orders\\\": bo_list, \\n    \\\"stock_batches\\\": stock_batches\\n}\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769154578402\",\"^1E\",\"~m1769163000740\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code17\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code17\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nimport json\\n\\n# ==============================================================================\\n# 1. GATHER DATA\\n# ==============================================================================\\ntry:\\n    # A. Simulation Results\\n    sim_data = code16.data\\n    stocks_df = pd.DataFrame(sim_data['stocks'])\\n    \\n    # B. Receipt Plan\\n    receipts = []\\n    for uuid, plan in sim_data['receipt_plan'].items():\\n        for r in plan:\\n            receipts.append(r)\\n    receipts_df = pd.DataFrame(receipts)\\n    \\n    # C. Real Sales\\n    sales_data = get_shop_data3.data\\n    sales_df = pd.DataFrame(sales_data)\\n    sales_df['placed'] = pd.to_datetime(sales_df['placed']).dt.floor('d')\\n    \\n    # D. Products\\n    products_df = pd.DataFrame(get_shop_data2.data)\\n    \\nexcept NameError:\\n    return {\\\"error\\\": \\\"Missing input data.\\\"}\\n\\n# ==============================================================================\\n# 2. BUILD CHARTS FOR ALL PRODUCTS\\n# ==============================================================================\\ncharts = {}\\n\\n# Iterate through EVERY product in the dataset\\nfor index, prod in products_df.iterrows():\\n    p_id = prod['id']\\n    # Handle potential missing names or formatting\\n    p_name = prod['name'].split('(')[0].strip() if 'name' in prod and prod['name'] else f\\\"Product {p_id}\\\"\\n    \\n    # 1. Filter Data for this Product\\n    p_stock = stocks_df[stocks_df['product_id'] == p_id].sort_values('date')\\n    p_sales = sales_df[sales_df['product_id'] == p_id].groupby('placed')['quantity'].sum().reset_index()\\n    \\n    # Filter receipts\\n    if not receipts_df.empty:\\n        p_receipts = receipts_df[receipts_df['productId'] == p_id].copy()\\n        if not p_receipts.empty:\\n            p_receipts['occurred'] = pd.to_datetime(p_receipts['occurred']).dt.floor('d')\\n    else:\\n        p_receipts = pd.DataFrame()\\n\\n    # 2. Structure for Plotly\\n    # Trace A: Stock Level\\n    trace_stock = {\\n        \\\"x\\\": p_stock['date'].tolist(),\\n        \\\"y\\\": p_stock['quantity'].tolist(),\\n        \\\"type\\\": \\\"scatter\\\",\\n        \\\"mode\\\": \\\"lines\\\",\\n        \\\"name\\\": \\\"Stock\\\",\\n        \\\"fill\\\": \\\"tozeroy\\\",\\n        \\\"line\\\": {\\\"color\\\": \\\"#6366f1\\\"}\\n    }\\n    \\n    # Trace B: Sales\\n    trace_sales = {\\n        \\\"x\\\": p_sales['placed'].dt.strftime('%Y-%m-%d').tolist(),\\n        \\\"y\\\": p_sales['quantity'].tolist(),\\n        \\\"type\\\": \\\"bar\\\",\\n        \\\"name\\\": \\\"Sales\\\",\\n        \\\"marker\\\": {\\\"color\\\": \\\"#ef4444\\\"}\\n    }\\n    \\n    # Trace C: Receipts\\n    trace_receipts = {}\\n    if not p_receipts.empty:\\n        trace_receipts = {\\n            \\\"x\\\": p_receipts['occurred'].dt.strftime('%Y-%m-%d').tolist(),\\n            \\\"y\\\": p_receipts['quantity'].tolist(),\\n            \\\"type\\\": \\\"bar\\\",\\n            \\\"name\\\": \\\"Incoming\\\",\\n            \\\"marker\\\": {\\\"color\\\": \\\"#10b981\\\"}\\n        }\\n    \\n    # Add to charts dictionary keyed by Product Name\\n    charts[p_name] = {\\n        \\\"data\\\": [trace_stock, trace_sales, trace_receipts],\\n        \\\"layout\\\": {\\n            \\\"title\\\": f\\\"Twin: {p_name}\\\",\\n            \\\"xaxis\\\": {\\\"title\\\": \\\"Date\\\"},\\n            \\\"yaxis\\\": {\\\"title\\\": \\\"Qty\\\"},\\n            \\\"barmode\\\": \\\"overlay\\\"\\n        }\\n    }\\n\\nreturn charts\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769154931591\",\"^1E\",\"~m1769155766786\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code18\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code18\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"# 1. Get Stock History from the Simulation\\nstock_data = code16.data['stocks']\\n\\n# 2. Batching Settings\\nbatch_size = 2000 \\n\\n# 3. Chunk the data\\nbatches = [stock_data[i:i + batch_size] for i in range(0, len(stock_data), batch_size)]\\n\\nreturn batches\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769158332878\",\"^1E\",\"~m1769158350539\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code19\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code19\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"// Skips the first 2 items (indexes 0 and 1) and returns everything else\\nreturn code16.data.buy_orders.slice(2);\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769162003397\",\"^1E\",\"~m1769163189575\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"loop10\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"loop10\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"RESTQuery\",\"^1:\",null,\"^1;\",\"Optiply Public API\",\"^1<\",\"Optiply Public API\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"paginationLimit\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"openAPIRequestBody\",\"\",\"streamResponse\",false,\"body\",\"{{ value }}\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"paginationPaginationField\",\"\",\"workflowRunExecutionType\",\"sync\",\"headers\",\"[{\\\"key\\\":\\\"Content-Type\\\",\\\"value\\\":\\\"application/vnd.api+json\\\"}]\",\"showFailureToaster\",true,\"paginationEnabled\",false,\"query\",\"https://api.optiply.com/v1/buyOrders?accountId=1380\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"cookies\",\"\",\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"paginationDataField\",\"\",\"timestamp\",0,\"openAPIParams\",\"{}\",\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"version\",2,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"type\",\"POST\",\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"bodyType\",\"raw\",\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769162490228\",\"^1E\",\"~m1769162490228\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code20\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code20\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"// 1. Get Data\\nconst batches = code16.data.stock_batches;\\nconst allRows = batches.flat();\\n\\n// 2. Build the VALUES part\\n// Filters out bad data and maps to SQL format: (1, 'uuid', 2, 'uuid', 50, '2025-01-01')\\nconst valuesList = allRows\\n  .filter(row => row.product_uuid && row.webshop_uuid)\\n  .map(row => {\\n    // Note the single quotes around UUIDs and Date\\n    return `(${row.product_id}, '${row.product_uuid}', ${row.webshop_id}, '${row.webshop_uuid}', ${row.quantity}, '${row.date} 00:00:02')`;\\n  })\\n  .join(\\\",\\\"); // Joins them with commas\\n\\n// 3. Construct the FINAL Statement\\n// This matches your R paste0 logic\\nconst finalQuery = `\\nINSERT INTO stocks \\n  (product_id, product_uuid, webshop_id, webshop_uuid, on_hand, date)\\nVALUES \\n  ${valuesList}\\nON CONFLICT (product_id, date) \\nDO UPDATE SET\\n  on_hand = EXCLUDED.on_hand;\\n`;\\n\\nreturn finalQuery;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769163778958\",\"^1E\",\"~m1769165123093\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code21\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code21\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"const finalQuery = `\\nSELECT \\n    -- Product Details\\n    wp.id,\\n  wp.uuid as product_uuid,\\n    wp.shop_id,\\n  wp.shop_uuid as webshop_uuid,\\n    wp.name,\\n    wp.sku,\\n    wp.price AS selling_price,\\n    wp.current_stock_on_hand,\\n    \\n    -- Financials & Lead Times\\n    sp.price AS purchase_price,\\n    -- Priority: Specific Product > General Supplier > Default 14\\n    COALESCE(sp.delivery_time, s.delivery_time, 14) AS product_delivery_time,\\n    \\n    -- Supplier Info\\n    s.id AS supplier_id\\n\\nFROM webshop_products wp \\nJOIN supplier_products sp ON wp.id = sp.webshop_product_id\\nJOIN suppliers s ON s.id = sp.supplier_id\\nWHERE s.webshop_id = 1380;\\n`;\\n\\nreturn finalQuery;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769165185477\",\"^1E\",\"~m1769165208074\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query6\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query6\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"INSERT INTO stocks \\n  (product_id, product_uuid, webshop_id, webshop_uuid, on_hand, date)\\nVALUES \\n  (28666307, '0e006d66-ee63-4b15-a26e-27406c3d55ed', 1380, 'b6aba3eb-4412-4b3c-a261-2073f7fdb152', 91, '2026-02-01 00:00:02'),(28666307, '0e006d66-ee63-4b15-a26e-27406c3d55ed', 1380, 'b6aba3eb-4412-4b3c-a261-2073f7fdb152', 91, '2026-01-31 00:00:02');\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"120000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769166669975\",\"^1E\",\"~m1770041342443\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query7\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query7\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"UPDATE stocks\\nSET \\n  deleted_at = NOW()\\nwhere \\nproduct_id in (28666283,28666286,28666287,28666288,28666289,28666290,28666291,28666292,28666293,28666294,28666295,28666296,28666297,28666298,28666299,28666300,28666301,28666302,28666303,28666304,28666305,28666306,28666307,28666308,28666309,28666310,28666311,28666312,28666313,28666314,28666315,28666316)\\nand date > CURRENT_DATE + interval '1 day';\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769492455414\",\"^1E\",\"~m1769497196475\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query8\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query8\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"UPDATE stocks\\nSET deleted_at = NOW()\\nWHERE product_id IN (\\n    28666283,28666286,28666287,28666288,28666289,28666290,28666291,28666292,28666293,28666294,28666295,28666296,28666297,28666298,28666299,28666300,28666301,28666302,28666303,28666304,28666305,28666306,28666307,28666308,28666309,28666310,28666311,28666312,28666313,28666314,28666315,28666316\\n)\\nand webshop_id = 1380\\n  AND deleted_at IS NULL;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769950188225\",\"^1E\",\"~m1769950326124\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query9\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query9\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1769955122333\",\"^1E\",\"~m1769955151502\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query10\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query10\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"Optiply_ProductionDB\",\"^1<\",\"Optiply_Production\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"UPDATE stocks\\nSET deleted_at = NOW()\\nWHERE product_id = 28666307\\n  AND deleted_at IS NULL;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"120000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1770041501081\",\"^1E\",\"~m1770041529288\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]]]],\"preloadedAppJavaScript\",null,\"preloadedAppJSLinks\",[],\"queryStatusVisibility\",false,\"responsiveLayoutDisabled\",false,\"rootScreen\",null,\"savePlatform\",\"web\",\"shortlink\",null,\"testEntities\",[],\"tests\",[],\"urlFragmentDefinitions\",[\"^A\",[]],\"version\",\"3.344.0\",\"serializedLayout\",null,\"agentEvals\",[\"^ \"]]]]","triggerWebhooks":[{"name":"startTrigger","uuid":"startTrigger","headers":"{}","inputSchema":{"properties":[]},"useHeaderApiKey":false,"exampleInputJSON":"","examplePathParams":""}],"customLibraries":[{"version":"4.17.21","language":"javascript","variable":"_","codeString":"/* Edit library variable below */\n\nconst _ = require('lodash')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n","libraryName":"lodash"},{"version":"2.1.0","language":"javascript","variable":"numbro","codeString":"/* Edit library variable below */\n\nconst numbro = require('numbro')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n","libraryName":"numbro"},{"version":"5.3.2","language":"javascript","variable":"Papa","codeString":"/* Edit library variable below */\n\nconst Papa = require('papaparse')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n","libraryName":"papaparse"},{"version":"0.5.23","language":"javascript","variable":"moment","codeString":"/* Edit library variable below */\n\nconst moment = require('moment-timezone')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n","libraryName":"moment-timezone"},{"version":"3.4.0","language":"javascript","variable":"uuid","codeString":"/* Edit library variable below */\n\nconst uuid = require('uuid')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n","libraryName":"uuid"}],"createdBy":323630,"protected":false,"setupScripts":{"python":{"codeString":""},"javascript":{"codeString":"// lodash\n/* Edit library variable below */\n\nconst _ = require('lodash')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// numbro\n/* Edit library variable below */\n\nconst numbro = require('numbro')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// papaparse\n/* Edit library variable below */\n\nconst Papa = require('papaparse')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// moment-timezone\n/* Edit library variable below */\n\nconst moment = require('moment-timezone')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// uuid\n/* Edit library variable below */\n\nconst uuid = require('uuid')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n"}},"subflows":[],"type":"workflow","iconName":null,"iconColor":null,"private":false,"hasProtectedTriggers":false,"protectedTriggers":[],"readme":null}